<?xml version="1.0" encoding="US-ASCII" ?>
<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
    <!ENTITY RFC2119 SYSTEM "http://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.2119.xml">
]>

<?xml-stylesheet type="text/xsl" href="rfc2629.xslt" ?>
<?rfc strict="yes" ?>

<rfc 
    category="std" 
    docName="coe-151-mp1-protocol-05" 
    ipr="trust200902" 
    consensus="no" 
    submissionType="independent" 
    updates="5" 
    xml:lang="en"
>
    <front>
        <title abbrev="CoE 151 MP Protocol">
            Server-Client and Peer-Peer Communication Protocol
        </title>

        <author fullname="Keith Vargas" initials="K." surname="Vargas">
            <organization abbrev="EEEI">Electrical and Electronics Engineering Institute</organization>
            <address>
                <postal>
                    <street>P. Velasquez St.</street>
                    <city>Quezon City</city>
                    <region>Metro Manila</region>
                    <code>1101</code>
                    <country>Philippines</country>
                </postal>
                <email>keith.vargas@eee.upd.edu.ph</email>
            </address>
        </author>

        <!-- Insert yourselves here using the author element similar to mine above -->

        <date year="2020" month="March" />
        <area>General</area>
        <workgroup>CoE 151</workgroup>
        <keyword>MP1</keyword>

        <abstract>
            <t>
                This document describes the communication protocol of the server-client model and
                peer-peer model. This will not cover rules and restrictions for implementations of
                the control logic and processing of user input. Message formats are described along
                with their use cases. Handshake / login, state transitions, and terminations are 
                also described below.
            </t>
        </abstract>

        <note title="Disclaimer">
            <t>
                The template used is from <xref target="RFC3470"/>. The document attempts to follow
                guidelines set in <xref target="RFC6949"/>.
            </t>
        </note>
    </front>
    <middle>
        <section anchor="intro" title="Introduction">
            <t>
                Chat servers are simple applications if written by a single entity. The lack of 
                implementation rules adds complexity on ensuring that two applications communicate
                with each other properly. 
            </t>
        </section>
        <section anchor="mtypes" title="Message Formats">
            <section anchor="mintro" title="Introduction">
                <t>
                    Messages sent by both server-client and peer-peer models shall be encoded in
                    JavaScript Object Notation (JSON). This is to simplify the parsing process in
                    the individual implementations. There are several valid entries of the messages 
                    for this protocol. Message formats are identified by the entry "mtp". The particular 
                    information for the rest of the entries will be discussed in detail in their 
                    respective use cases in the message formats.
                </t>
            </section>
            <section anchor="serverbound" title="Serverbound Messages">
                <section anchor="Login" title="Login">
                    <t>
                        This is the first packet a client should send to the server. A sample message of
                        this format is shown below:
                    </t>
                    <t>
                        {"mtp": "Login", "data": {"name": "username"}}
                    </t>
                    <texttable title="Login Entries">
                        <ttcol>Entry</ttcol>
                        <ttcol>Data Type</ttcol>
                        <ttcol align="center">Description</ttcol>
        
                        <c>mtp</c>
                        <c>string</c>
                        <c>MessageType. All Login messages have this value set to "Login"</c>
        
                        <c>name</c>
                        <c>string</c>
                        <c>Client Name. The username that the client requests to use to join the server.</c>
                    </texttable>
                    <t>
                        The server must send an AssignUsername message as a response to this message. This is
                        discussed in detail in <xref target="server-client-state-login"/>
                    </t>
                </section>
                <section anchor="SetUsername" title="SetUsername">
                    <t>
                        On the scenario that a client wishes to change usernames, this message will be sent to
                        the server. A sample message of this format is shown below:
                    </t>
                    <t>
                        {"mtp": "SetUsername", "data": {"name": "new_name"}}
                    </t>
                    <texttable title="SetUsername Entries">
                        <ttcol>Entry</ttcol>
                        <ttcol>Data Type</ttcol>
                        <ttcol align="center">Description</ttcol>
        
                        <c>mtp</c>
                        <c>string</c>
                        <c>MessageType. All SetUsername messages have this value set to "SetUsername"</c>
        
                        <c>name</c>
                        <c>string</c>
                        <c>Requested new name by the client.</c>
                    </texttable>
                    <t>
                        The server must send a SetUsername message as a response to this message. This is
                        discussed in detail in <xref target="server-client-behavior-changename"/>
                    </t>
                </section> 
                <section anchor="RequestUserInfo" title="RequestUserInfo">
                    <t>
                        On the scenario that a client wishes to view a user's network information, this message will be 
                        sent to the server. A sample message of this format is shown below:
                    </t>
                    <t>
                        {"mtp": "RequestUserInfo", "data": {"name": "username"}}
                    </t>
                    <texttable title="RequestUserInfo Entries">
                        <ttcol>Entry</ttcol>
                        <ttcol>Data Type</ttcol>
                        <ttcol align="center">Description</ttcol>
        
                        <c>mtp</c>
                        <c>string</c>
                        <c>MessageType. All RequestUserInfo messages have this value set to "RequestUserInfo"</c>
        
                        <c>name</c>
                        <c>string</c>
                        <c>Name of the user whose information is being requested.</c>
                    </texttable>
                    <t>
                        The server must send a ProvideUserInfo message as a response to this message. This is
                        discussed in detail in <xref target="server-client-behavior-userinfo"/>
                    </t>
                </section>
                <section anchor="RequestLocalTime" title="RequestLocalTime">
                    <t>
                        On the scenario that a client wishes to change usernames, this message will be sent
                        to the server. A sample message of this format is shown below:
                    </t>
                    <t>
                        {"mtp": "RequestLocalTime", "data": {}}
                    </t>
                    <texttable title="RequestLocalTime Entries">
                        <ttcol>Entry</ttcol>
                        <ttcol>Data Type</ttcol>
                        <ttcol align="center">Description</ttcol>
        
                        <c>mtp</c>
                        <c>string</c>
                        <c>MessageType. All RequestLocalTime messages have this value set to "RequestLocalTime"</c>
                    </texttable>
                    <t>
                        The server must send a SendLocalTime message as a response to this message. This is
                        discussed in detail in <xref target="server-client-behavior-localtime"/>
                    </t>
                </section>
                <section anchor="WhisperToUser" title="WhisperToUser">
                    <t>
                        On the scenario that a client wishes to send a private message to another user, this 
                        message will be sent to the server. A sample message of this format is shown below:
                    </t>
                    <t>
                        {"mtp": "WhisperToUser", "data": {"to": ["user1", "user2", "user3"], "message": "hi"}}
                    </t>
                    <texttable title="WhisperToUser Entries">
                        <ttcol>Entry</ttcol>
                        <ttcol>Data Type</ttcol>
                        <ttcol align="center">Description</ttcol>
        
                        <c>mtp</c>
                        <c>string</c>
                        <c>MessageType. All WhisperToUser messages have this value set to "WhisperToUser"</c>
        
                        <c>to</c>
                        <c>array of strings</c>
                        <c>List of users the private message is addressed to.</c>
        
                        <c>message</c>
                        <c>string</c>
                        <c>The private message to be sent.</c>
                    </texttable>
                    <t>
                        Behavior is discussed in detail in <xref target="server-client-behavior-whisper"/>
                    </t>
                </section>
            </section>
            <section anchor="clientbound" title="Clientbound Messages">
                <t>
                    message
                </t>
            </section>
            <section anchor="peer2peer" title="Peer-Peer Messages">
                <t>
                    message
                </t>
            </section>
        </section>
        <section anchor="server-client" title="Server-Client Model">
            <section anchor="server-client-state" title="States / Phases">
                <section anchor="server-client-state-login" title="Login">
                    <t>
                        hi
                    </t>
                </section>
            </section>
            <section anchor="server-client-behavior" title="Request-Response Behavior">
                <section anchor="server-client-behavior-changename" title="SetUsername">
                    <t>
                        hi
                    </t>
                </section>
                <section anchor="server-client-behavior-userinfo" title="UserInfo">
                    <t>
                        hi
                    </t>
                </section>
                <section anchor="server-client-behavior-localtime" title="LocalTime">
                    <t>
                        hi
                    </t>
                </section>
                <section anchor="server-client-behavior-whisper" title="Whisper">
                    <t>
                        hi
                    </t>
                </section>
            </section>
        </section>
    </middle>

    <back>
        <references title="Normative References">
            <reference anchor="RFC3470">
                <front>
                    <title>Guidelines for the Use of Extensible Markup Language (XML)
                        within IETF Protocols</title>
                    <author initials="S." surname="Hollenbeck" fullname="Scott Hollenbeck">
                        <organization abbrev="VeriSign, Inc.">VeriSign, Incorporated</organization>
                    </author>
                    <author initials="M." surname="Rose" fullname="Marshall T. Rose">
                        <organization abbrev="Dover Beach Consulting, Inc.">Dover Beach Consulting, Incorporated</organization>
                    </author>
                    <author initials="L." surname="Masinter" fullname="Larry Masinter">
                        <organization abbrev="Adobe Systems Inc.">Adobe Systems Incorporated</organization>
                    </author>
                    <date year="2013" month="May" />
                </front>
                <seriesInfo name="RFC" value="3470" />
                <annotation>This is a primary reference work.</annotation>
            </reference>
        </references>

        <references title="Informative References">
            <reference anchor="RFC6949">
                <front>
                    <title>RFC Series Format Requirements and Future Development</title>
                    <author initials="H." surname="Flanagan" fullname="H. Flanagan">
                        <organization />
                    </author>
                    <author initials="N." surname="Brownlee" fullname="N. Brownlee">
                        <organization />
                    </author>
                    <date year="2013" month="May" />
                </front>
                <seriesInfo name="RFC" value="6949" />
                <annotation>This is a primary reference work.</annotation>
            </reference>
        </references>
    </back>
</rfc>